<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Gmail Account Creator</title>
    <link rel="icon" type="image/x-icon" href="gmail.ico" id="faviconLink">
    <link rel="stylesheet" href="style.css?v=2.0">
    <style>
        /* Navigation Tabs - Hidden */
        .nav-tabs {
            display: none !important;
        }
        .tab-content {
            display: none;
        }
        
        /* Hide Footer only on Setup Task page */
        #tab-setup .btn-logout {
            display: none !important;
        }
        
        .footer.hidden {
            display: none !important;
        }
    </style>
</head>
<body>
    <div class="main-container">
        <!-- TAB 1: SETUP (Show by default) -->
        <div id="tab-setup" class="tab-content" style="display: block;">
            <div class="card setup-card">
                <div class="setup-content">
                    <div class="setup-logo" id="gmailLogoContainer">
                        <!-- Logo máº·c Ä‘á»‹nh Ä‘Ã£ bá»‹ xÃ³a - chá»‰ hiá»ƒn thá»‹ logo custom náº¿u cÃ³ upload -->
                    </div>
                    <h1 class="setup-heading">Setup Task</h1>
                    <form class="setup-form" onsubmit="handleSetup(event); return false;">
                        <div class="form-group">
                            <label class="form-label">Select Server Region</label>
                            <div class="select-wrapper">
                                <select id="serverRegion" name="serverRegion" class="form-select" required>
                                    <option value="us">ðŸ‡ºðŸ‡¸ United States (Premium)</option>
                                    <option value="uk">ðŸ‡¬ðŸ‡§ United Kingdom</option>
                                    <option value="de">ðŸ‡©ðŸ‡ª Germany</option>
                                    <option value="fr">ðŸ‡«ðŸ‡· France</option>
                                    <option value="jp">ðŸ‡¯ðŸ‡µ Japan</option>
                                    <option value="sg">ðŸ‡¸ðŸ‡¬ Singapore</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Number of Accounts</label>
                            <input type="number" id="numberOfAccounts" name="numberOfAccounts" class="form-input" value="1" min="1" max="100" required>
                        </div>
                        <div class="setup-actions">
                            <button type="submit" class="btn-start-automation" id="startAutomationBtn">
                                <span>Start Automation</span>
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- TAB: LICENSE CARD (Hiá»ƒn thá»‹ khi Ä‘Ã£ táº¡o Gmail Ä‘áº§u tiÃªn) -->
        <div id="tab-license" class="tab-content" style="display: none;">
            <div class="card setup-card">
                <div class="setup-content">
                    <div class="setup-logo" id="licenseLogoContainer">
                        <!-- Logo máº·c Ä‘á»‹nh Ä‘Ã£ bá»‹ xÃ³a - chá»‰ hiá»ƒn thá»‹ logo custom náº¿u cÃ³ upload -->
                    </div>
                    <h1 class="setup-heading" style="color: #EA4335;">Limit Reached!</h1>
                    
                    <div style="text-align: center; margin: 24px 0;">
                        <p style="color: #9AA0A6; font-size: 16px; margin-bottom: 16px; line-height: 1.6;">
                            <strong style="color: #FFFFFF;">Each IP can only create 1 account</strong> (Gmail or Moitasec) for free.
                        </p>
                        <p style="color: #9AA0A6; font-size: 16px; margin-bottom: 16px; line-height: 1.6;">
                            <strong style="color: #EA4335;">VPN/Proxy is strictly prohibited!</strong> The system will automatically detect and block.
                        </p>
                        <p style="color: #9AA0A6; font-size: 16px; margin-bottom: 24px; line-height: 1.6;">
                            To create more accounts, please contact us via Telegram to purchase a license.
                        </p>
                        
                        <!-- QR Code Telegram - ÄÃ£ áº©n -->
                        
                        <!-- Avatar Telegram -->
                        <div style="margin: 24px 0; text-align: center;">
                            <div style="display: inline-block; width: 80px; height: 80px; border-radius: 50%; background: linear-gradient(135deg, #0088cc 0%, #0066aa 100%); display: flex; align-items: center; justify-content: center; margin: 0 auto; box-shadow: 0 4px 12px rgba(0, 136, 204, 0.3);">
                                <svg width="40" height="40" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM16.64 8.8C16.49 10.38 15.84 14.22 15.51 15.99C15.37 16.74 15.09 16.99 14.83 17.02C14.25 17.07 13.81 16.64 13.25 16.27C12.37 15.69 11.87 15.33 11.02 14.77C10.03 14.12 10.67 13.76 11.24 13.18C11.39 13.03 14.95 9.7 15.05 9.39C15.06 9.36 15.07 9.22 14.99 9.14C14.92 9.06 14.8 9.09 14.71 9.11C14.56 9.15 12.18 10.75 8.02 13.01C7.49 13.33 7.01 13.49 6.59 13.48C6.12 13.47 5.23 13.24 4.55 13.04C3.75 12.8 3.12 12.67 3.18 12.25C3.21 12.04 3.52 11.81 4.05 11.56C7.47 9.95 10.13 8.73 12.02 7.9C15.36 6.42 16.05 6.22 16.45 6.22C16.54 6.22 16.78 6.25 16.95 6.39C17.09 6.5 17.14 6.66 17.16 6.75C17.18 6.84 17.2 7.07 17.18 7.25C17.15 7.5 16.64 8.8 16.64 8.8Z" fill="white"/>
                                </svg>
                            </div>
                            <div style="color: #9AA0A6; font-size: 14px; margin-top: 8px; font-weight: 500;">@guishanghaii</div>
                        </div>
                        
                        <!-- Button Link Telegram -->
                        <a href="https://t.me/guishanghaii" target="_blank" class="btn-telegram" style="display: inline-flex; align-items: center; justify-content: center; gap: 8px; background: linear-gradient(135deg, #0088cc 0%, #0066aa 100%); color: white; padding: 14px 40px; border-radius: 24px; text-decoration: none; font-weight: 500; font-size: 16px; margin-top: 16px; width: 100%; box-sizing: border-box; transition: all 0.3s; box-shadow: 0 4px 12px rgba(0, 136, 204, 0.3);">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM16.64 8.8C16.49 10.38 15.84 14.22 15.51 15.99C15.37 16.74 15.09 16.99 14.83 17.02C14.25 17.07 13.81 16.64 13.25 16.27C12.37 15.69 11.87 15.33 11.02 14.77C10.03 14.12 10.67 13.76 11.24 13.18C11.39 13.03 14.95 9.7 15.05 9.39C15.06 9.36 15.07 9.22 14.99 9.14C14.92 9.06 14.8 9.09 14.71 9.11C14.56 9.15 12.18 10.75 8.02 13.01C7.49 13.33 7.01 13.49 6.59 13.48C6.12 13.47 5.23 13.24 4.55 13.04C3.75 12.8 3.12 12.67 3.18 12.25C3.21 12.04 3.52 11.81 4.05 11.56C7.47 9.95 10.13 8.73 12.02 7.9C15.36 6.42 16.05 6.22 16.45 6.22C16.54 6.22 16.78 6.25 16.95 6.39C17.09 6.5 17.14 6.66 17.16 6.75C17.18 6.84 17.2 7.07 17.18 7.25C17.15 7.5 16.64 8.8 16.64 8.8Z" fill="white"/>
                            </svg>
                            <span>Contact Telegram: @guishanghaii</span>
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- TAB 2: CREATE ACCOUNT (Hidden by default) -->
        <div id="tab-create" class="tab-content" style="display: none;">
            <!-- Step 1: Nháº­p tÃªn -->
            <div class="card step" id="step1">
                <div class="card-content">
                    <div class="left-section">
                        <div class="google-logo">
                            <svg width="24" height="24" viewBox="0 0 24 24">
                                <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                                <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                                <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                                <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                            </svg>
                        </div>
                        <h1>Create Google Account</h1>
                        <p class="subtitle">Enter your name</p>
                    </div>
                    <div class="right-section">
                        <form class="registration-form" onsubmit="return false;">
                            <div class="form-group">
                                <input type="text" id="lastName" name="lastName" placeholder="Last name (optional)">
                            </div>
                            <div class="form-group">
                                <input type="text" id="firstName" name="firstName" placeholder="First name" required>
                            </div>
                            <div class="form-actions">
                                <button type="button" id="step1NextBtn" class="btn-primary">Next</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Step 2: ThÃ´ng tin cÆ¡ báº£n -->
            <div class="card step" id="step2" style="display: none;">
                <div class="card-content">
                    <div class="left-section">
                        <div class="google-logo">
                            <svg width="24" height="24" viewBox="0 0 24 24">
                                <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                                <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                                <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                                <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                            </svg>
                        </div>
                        <h1>Basic Information</h1>
                        <p class="subtitle">Enter your date of birth and gender</p>
                    </div>
                    <div class="right-section">
                        <form class="registration-form" onsubmit="return false;">
                            <div class="date-group">
                                <div class="form-group">
                                    <input type="number" id="day" name="day" placeholder="Day" min="1" max="31" required>
                                </div>
                                <div class="form-group">
                                    <select id="month" name="month" required>
                                        <option value="">Month</option>
                                        <option value="1">January</option>
                                        <option value="2">February</option>
                                        <option value="3">March</option>
                                        <option value="4">April</option>
                                        <option value="5">May</option>
                                        <option value="6">June</option>
                                        <option value="7">July</option>
                                        <option value="8">August</option>
                                        <option value="9">September</option>
                                        <option value="10">October</option>
                                        <option value="11">November</option>
                                        <option value="12">December</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <input type="number" id="year" name="year" placeholder="Year" min="1900" max="2024" required>
                                </div>
                            </div>
                            <div class="form-group">
                                <select id="gender" name="gender" required>
                                    <option value="">Gender</option>
                                    <option value="male">Male</option>
                                    <option value="female">Female</option>
                                    <option value="other">Other</option>
                                </select>
                            </div>
                            <a href="#" class="info-link">Why we ask for your date of birth and gender</a>
                            <div class="form-actions">
                                <button type="button" class="btn-secondary" onclick="goToStep(1)">Back</button>
                                <button type="button" class="btn-primary" onclick="handleStep2(event)">Next</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Step 3: Táº¡o email -->
            <div class="card step" id="step3" style="display: none;">
                <div class="card-content">
                    <div class="left-section">
                        <div class="google-logo">
                            <svg width="24" height="24" viewBox="0 0 24 24">
                                <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                                <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                                <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                                <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                            </svg>
                        </div>
                        <h1>Create an email address</h1>
                        <p class="subtitle">Create a Gmail address to sign in to your Google Account</p>
                    </div>
                    <div class="right-section">
                        <form class="registration-form" onsubmit="return false;">
                            <div class="radio-group">
                                <label class="radio-label">
                                    <input type="radio" name="emailOption" value="suggested1" checked>
                                    <span id="suggestedEmail1"></span>
                                </label>
                                <label class="radio-label">
                                    <input type="radio" name="emailOption" value="suggested2">
                                    <span id="suggestedEmail2"></span>
                                </label>
                                <label class="radio-label">
                                    <input type="radio" name="emailOption" value="custom">
                                    <span>Create your own Gmail address</span>
                                </label>
                            </div>
                            <div id="customEmailGroup" style="display: none;" class="form-group">
                                <div class="email-input-wrapper">
                                    <input type="text" id="customEmail" placeholder="Create a Gmail address" pattern="[a-z0-9._]+">
                                    <span class="email-suffix">@gmail.com</span>
                                </div>
                                <p class="email-hint">You can use letters, numbers, and periods</p>
                            </div>
                            <div class="form-actions">
                                <button type="button" class="btn-secondary" onclick="goToStep(2)">Back</button>
                                <div style="display: flex; gap: 12px; margin-left: auto;">
                                    <button type="button" class="btn-secondary" id="useCurrentEmailBtn" onclick="showUseCurrentEmail()">Use your current email</button>
                                    <button type="button" class="btn-primary" onclick="handleStep3(event)">Next</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Step 3b: Sá»­ dá»¥ng email hiá»‡n táº¡i -->
            <div class="card step" id="step3b" style="display: none;">
                <div class="card-content">
                    <div class="left-section">
                        <div class="google-logo">
                            <svg width="24" height="24" viewBox="0 0 24 24">
                                <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                                <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                                <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                                <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                            </svg>
                        </div>
                        <h1>Use your current email</h1>
                        <p class="subtitle">Enter the email address you want to use for your Google Account</p>
                    </div>
                    <div class="right-section">
                        <form class="registration-form" onsubmit="return false;">
                            <div class="form-group floating-label">
                                <input type="email" id="currentEmail" name="currentEmail" placeholder=" " required>
                                <label for="currentEmail">Email address</label>
                            </div>
                            <p class="info-text">You'll need to verify that this email belongs to you</p>
                            <a href="#" class="info-link" onclick="event.preventDefault(); goToStep(3);">Create a Gmail address</a>
                            <div class="form-actions">
                                <button type="button" class="btn-secondary" onclick="goToStep(3)">Back</button>
                                <button type="button" class="btn-primary" onclick="handleStep3b(event)">Next</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Step 4: Táº¡o máº­t kháº©u -->
            <div class="card step" id="step4" style="display: none;">
                <div class="card-content">
                    <div class="left-section">
                        <div class="google-logo">
                            <svg width="24" height="24" viewBox="0 0 24 24">
                                <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                                <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                                <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                                <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                            </svg>
                        </div>
                        <h1>Create a strong password</h1>
                        <p class="subtitle">Create a strong password with a mix of letters, numbers, and symbols</p>
                    </div>
                    <div class="right-section">
                        <form class="registration-form" onsubmit="return false;">
                            <div class="form-group floating-label">
                                <input type="password" id="password" name="password" placeholder=" " required minlength="8">
                                <label for="password">Password</label>
                            </div>
                            <div class="form-group floating-label">
                                <input type="password" id="confirmPassword" name="confirmPassword" placeholder=" " required>
                                <label for="confirmPassword">Confirm</label>
                            </div>
                            <div class="checkbox-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="showPassword">
                                    <span>Show password</span>
                                </label>
                            </div>
                            <div class="form-actions">
                                <button type="button" class="btn-secondary" onclick="goToPreviousStep()">Back</button>
                                <button type="button" class="btn-primary" onclick="handleStep4(event)">Next</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Success Modal -->
            <div id="successModal" class="success-modal" style="display: none;">
                <div class="success-modal-content">
                    <div class="success-icon">
                        <svg width="120" height="120" viewBox="0 0 120 120" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <circle cx="60" cy="60" r="60" fill="#34A853" opacity="0.1"/>
                            <circle cx="60" cy="60" r="50" fill="#34A853"/>
                            <path d="M40 60L55 75L80 45" stroke="white" stroke-width="7" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </div>
                    <h2 class="success-title">Success!</h2>
                    <p class="success-message" id="successCountMessage">All accounts created successfully</p>
                    <button type="button" class="btn-success-close" onclick="closeSuccessModal()">Close</button>
                </div>
            </div>

                </div>
            </div>

            <!-- Accounts List -->
            <div id="accountsList" class="accounts-list" style="display: none;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 12px;">
                    <h2 style="flex: 1; min-width: 200px;">Created Accounts List</h2>
                    <div style="display: flex; gap: 12px; flex-wrap: wrap; width: 100%;">
                        <button type="button" class="btn-download" onclick="downloadAccounts('text')" style="background-color: #34A853; color: white; border: none; padding: 8px 16px; border-radius: 8px; cursor: pointer; font-size: 14px; font-weight: 500; min-height: 44px; flex: 1; min-width: 100px; -webkit-tap-highlight-color: transparent; touch-action: manipulation;">
                            Download TXT
                        </button>
                        <button type="button" class="btn-download" onclick="downloadAccounts('json')" style="background-color: #8AB4F8; color: #202124; border: none; padding: 8px 16px; border-radius: 8px; cursor: pointer; font-size: 14px; font-weight: 500; min-height: 44px; flex: 1; min-width: 100px; -webkit-tap-highlight-color: transparent; touch-action: manipulation;">
                            Download JSON
                        </button>
                        <button type="button" onclick="goToSetupTask()" style="background-color: #5F6368; color: white; border: none; padding: 8px 16px; border-radius: 8px; cursor: pointer; font-size: 14px; font-weight: 500; min-height: 44px; flex: 1; min-width: 100px; -webkit-tap-highlight-color: transparent; touch-action: manipulation;">
                            Back to Setup Task
                        </button>
                    </div>
                </div>
                <div id="accountsContainer" class="accounts-container">
                    <p class="empty-message">No accounts yet. Create your first account!</p>
                </div>
            </div>
        </div>

        <!-- TAB 3: ADMIN (Hidden by default) -->
        <div id="tab-admin" class="tab-content" style="display: none;">
            <!-- Header Bar with Logo and Favicon -->
            <div class="admin-header" style="background-color: #1a1a1a; border-bottom: 1px solid #5F6368; padding: 16px 24px; margin-bottom: 24px; display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 16px;">
                <div style="display: flex; align-items: center; gap: 16px;">
                    <div id="adminLogoContainer" style="width: 48px; height: 48px; display: flex; align-items: center; justify-content: center; border-radius: 8px; overflow: hidden; background-color: #2a2a2a;">
                        <!-- Logo will be loaded here -->
                    </div>
                    <div id="adminFaviconContainer" style="width: 32px; height: 32px; display: flex; align-items: center; justify-content: center;">
                        <!-- Favicon will be loaded here -->
                    </div>
                </div>
                <h1 class="setup-heading" style="margin: 0; font-size: 24px;">Admin Panel</h1>
            </div>
            
            <div class="card setup-card">
                <div class="setup-content">
                    <!-- Logo Management Section -->
                    <h2 class="setup-heading" style="font-size: 20px; margin-bottom: 16px; margin-top: 0;">Upload Logo</h2>
                    <form class="setup-form" id="logoUploadForm" onsubmit="return false;">
                        <div class="form-group">
                            <label class="form-label">Select Logo Image</label>
                            <input type="file" id="logoInput" name="logo" accept="image/*" class="form-input" style="padding: 8px;">
                        </div>
                        <div class="setup-actions">
                            <button type="submit" class="btn-start-automation">
                                <span>Upload Logo</span>
                            </button>
                        </div>
                    </form>
                    <div id="logoMessage" style="margin-top: 16px; padding: 12px; border-radius: 4px; display: none;"></div>
                    
                    <!-- Favicon Management Section -->
                    <hr style="margin: 32px 0; border: none; border-top: 1px solid #5F6368;">
                    <h2 class="setup-heading" style="font-size: 20px; margin-bottom: 16px;">Upload Favicon</h2>
                    <form class="setup-form" id="faviconUploadForm" onsubmit="return false;">
                        <div class="form-group">
                            <label class="form-label">Select Favicon Image</label>
                            <input type="file" id="faviconInput" name="favicon" accept="image/*" class="form-input" style="padding: 8px;">
                        </div>
                        <div class="setup-actions">
                            <button type="submit" class="btn-start-automation">
                                <span>Upload Favicon</span>
                            </button>
                        </div>
                    </form>
                    <div id="faviconMessage" style="margin-top: 16px; padding: 12px; border-radius: 4px; display: none;"></div>
                    
                    <!-- Admin Password Section -->
                    <hr style="margin: 32px 0; border: none; border-top: 1px solid #5F6368;">
                    <h2 class="setup-heading" style="font-size: 20px; margin-bottom: 16px;">Change Admin Password</h2>
                    <form class="setup-form" id="changePasswordForm" onsubmit="return false;">
                        <div class="form-group">
                            <label class="form-label">Current Password</label>
                            <input type="password" id="currentPassword" name="currentPassword" class="form-input" placeholder="Enter current password" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">New Password</label>
                            <input type="password" id="newPassword" name="newPassword" class="form-input" placeholder="Enter new password" required minlength="6">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Confirm New Password</label>
                            <input type="password" id="confirmNewPassword" name="confirmNewPassword" class="form-input" placeholder="Confirm new password" required minlength="6">
                        </div>
                        <div class="setup-actions">
                            <button type="submit" class="btn-start-automation">
                                <span>Change Password</span>
                            </button>
                        </div>
                    </form>
                    <div id="passwordMessage" style="margin-top: 16px; padding: 12px; border-radius: 4px; display: none;"></div>
                    
                    <!-- IP Management Section -->
                    <hr style="margin: 32px 0; border: none; border-top: 1px solid #5F6368;">
                    <h2 class="setup-heading" style="font-size: 20px; margin-bottom: 16px;">IP Management</h2>
                    <div id="ipManagementSection">
                        <div id="ipListContainer" style="margin-top: 24px;">
                            <h3 style="font-size: 16px; color: #FFFFFF; margin-bottom: 12px;">Accessed IPs List:</h3>
                            <div id="ipList" style="display: flex; flex-direction: column; gap: 12px;">
                                <!-- IP list will be loaded here -->
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 32px;">
                        <button type="button" class="btn-logout" onclick="document.getElementById('tab-admin').style.display='none'; document.getElementById('tab-setup').style.display='block'; updateFooterVisibility();">
                            <span>Back to Setup</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>

    </div>

        </div>
    </div>

    <!-- Footer - Náº±m á»Ÿ dÆ°á»›i cÃ¹ng -->
    <div class="footer">
        <div class="footer-left">
            <select id="language" class="language-select">
                <option value="vi">Vietnamese</option>
                <option value="en">English</option>
            </select>
        </div>
        <div class="footer-right">
            <a href="#" class="footer-link">Help</a>
            <a href="#" class="footer-link">Privacy</a>
            <a href="#" class="footer-link">Terms</a>
        </div>
    </div>

    <script src="script.js?v=2.1"></script>
    <script>
        // áº¨n/hiá»‡n footer dá»±a trÃªn tab Ä‘ang hiá»ƒn thá»‹
        function updateFooterVisibility() {
            const tabSetup = document.getElementById('tab-setup');
            const footer = document.querySelector('.footer');
            
            if (tabSetup && footer) {
                // Náº¿u tab-setup Ä‘ang hiá»ƒn thá»‹, áº©n footer
                if (tabSetup.style.display === 'block' || 
                    window.getComputedStyle(tabSetup).display === 'block') {
                    footer.classList.add('hidden');
                } else {
                    footer.classList.remove('hidden');
                }
            }
        }
        
        // Kiá»ƒm tra khi trang load
        document.addEventListener('DOMContentLoaded', function() {
            updateFooterVisibility();
            
            // Theo dÃµi thay Ä‘á»•i display cá»§a tab-setup
            const tabSetup = document.getElementById('tab-setup');
            if (tabSetup) {
                const observer = new MutationObserver(function(mutations) {
                    mutations.forEach(function(mutation) {
                        if (mutation.type === 'attributes' && mutation.attributeName === 'style') {
                            updateFooterVisibility();
                        }
                    });
                });
                
                observer.observe(tabSetup, {
                    attributes: true,
                    attributeFilter: ['style']
                });
            }
        });
    </script>
    <script>
        // Tab Navigation (disabled - tabs are hidden)
        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.style.display = 'none';
            });
            document.getElementById(`tab-${tabName}`).style.display = 'block';
        }

        // Setup functions (from setup.html)
        const firstNames = ['Perry', 'Allan', 'Marshall', 'Billy', 'Larry', 'Jacob', 'Michael', 'Earl', 'Tyler', 'Scott', 'James', 'Robert', 'John', 'David', 'William', 'Richard', 'Joseph', 'Thomas', 'Charles', 'Daniel'];
        const lastNames = ['Montgomery', 'Sierra', 'Aguirre', 'Pollard', 'Houston', 'Person', 'Pruitt', 'Duffy', 'Dodson', 'Pineda', 'Smith', 'Johnson', 'Williams', 'Brown', 'Jones', 'Garcia', 'Miller', 'Davis', 'Rodriguez', 'Martinez'];
        const middleParts = ['Puh', 'Xon', 'Xav', 'Pax', 'Koj', 'Pul', 'Vah', 'Wug', 'Qun', 'Hur', 'Zob', 'Vas', 'Bab', 'Duz', 'Lur', 'Sal', 'Nob', 'Tuz', 'Kur', 'Wab'];
        
        function randomString(length, type = 'mixed') {
            const letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';
            const numbers = '0123456789';
            let chars = type === 'letters' ? letters : (type === 'numbers' ? numbers : letters + numbers);
            let result = '';
            for (let i = 0; i < length; i++) {
                result += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return result;
        }
        
        function randomNumber(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }
        
        // Danh sÃ¡ch tÃ i khoáº£n cÃ³ sáºµn Ä‘á»ƒ random
        const predefinedAccounts = [
            { email: 'PerryMontgomeryPuh64627@moitasec.com', password: 'Pob45516', firstName: 'Perry', lastName: 'Montgomery' },
            { email: 'AllanSierraXon35421Map97871@moitasec.com', password: 'Fuw22561', firstName: 'Allan', lastName: 'Sierra' },
            { email: 'MarshallAguirreXav18436Cuy15340@moitasec.com', password: 'Jan10568', firstName: 'Marshall', lastName: 'Aguirre' },
            { email: 'BillyPollardPax81080Puw53579@moitasec.com', password: 'Yal01029', firstName: 'Billy', lastName: 'Pollard' },
            { email: 'LarryHoustonKoj97931Zob18470@moitasec.com', password: 'Cub78920', firstName: 'Larry', lastName: 'Houston' },
            { email: 'JacobPersonPul70973Vas73297@moitasec.com', password: 'Ton07643', firstName: 'Jacob', lastName: 'Person' },
            { email: 'MichaelPruittVah26288Bab57863@moitasec.com', password: 'Noj45409', firstName: 'Michael', lastName: 'Pruitt' },
            { email: 'EarlDuffyWug16843Duz59427@moitasec.com', password: 'Nas20474', firstName: 'Earl', lastName: 'Duffy' },
            { email: 'TylerDodsonQun61090Lur35065@moitasec.com', password: 'Has21335', firstName: 'Tyler', lastName: 'Dodson' },
            { email: 'ScottPinedaHur10700Sal43681@moitasec.com', password: 'Gap88771', firstName: 'Scott', lastName: 'Pineda' },
            { email: 'LewisRobbinsHow21627Kaf78266@moitasec.com', password: 'Joy25116', firstName: 'Lewis', lastName: 'Robbins' },
            { email: 'EugeneDeleonJuq29125Dac08557@moitasec.com', password: 'Suq96229', firstName: 'Eugene', lastName: 'Deleon' },
            { email: 'VincentHancockXaq43615Jof07469@moitasec.com', password: 'Kag62608', firstName: 'Vincent', lastName: 'Hancock' },
            { email: 'KarlMunozVaz36370Kav94308@moitasec.com', password: 'Tuk42491', firstName: 'Karl', lastName: 'Munoz' },
            { email: 'ApolinarioValentineRad49385Daf07596@moitasec.com', password: 'Rom19630', firstName: 'Apolinario', lastName: 'Valentine' },
            { email: 'JackRiversBat02097Nut37587@moitasec.com', password: 'Dun05183', firstName: 'Jack', lastName: 'Rivers' },
            { email: 'MartinFieldsGus33787Jab90093@moitasec.com', password: 'Qop13079', firstName: 'Martin', lastName: 'Fields' },
            { email: 'AbordoLyndaGaq91817Xan53250@moitasec.com', password: 'Sah06600', firstName: 'Abordo', lastName: 'Lynda' },
            { email: 'MiltonLealNow01126Fum26548@moitasec.com', password: 'Poy74768', firstName: 'Milton', lastName: 'Leal' },
            { email: 'RossPalaciosZof59279Fad73077@moitasec.com', password: 'Sup39973', firstName: 'Ross', lastName: 'Palacios' }
        ];

        function generateMoitasecAccount() {
            // LuÃ´n dÃ¹ng tÃ i khoáº£n cÃ³ sáºµn tá»« danh sÃ¡ch, random chá»n
            if (predefinedAccounts.length > 0) {
                // Láº¥y danh sÃ¡ch accounts Ä‘Ã£ sá»­ dá»¥ng tá»« localStorage
                const usedAccounts = JSON.parse(localStorage.getItem('usedMoitasecAccounts') || '[]');
                
                // Lá»c ra cÃ¡c accounts chÆ°a Ä‘Æ°á»£c sá»­ dá»¥ng
                const availableAccounts = predefinedAccounts.filter(acc => !usedAccounts.includes(acc.email));
                
                // Náº¿u cÃ²n accounts chÆ°a dÃ¹ng, chá»n random tá»« Ä‘Ã³
                let selectedAccount;
                if (availableAccounts.length > 0) {
                    selectedAccount = availableAccounts[Math.floor(Math.random() * availableAccounts.length)];
                } else {
                    // Náº¿u Ä‘Ã£ dÃ¹ng háº¿t, reset vÃ  chá»n random tá»« toÃ n bá»™ danh sÃ¡ch
                    localStorage.removeItem('usedMoitasecAccounts');
                    selectedAccount = predefinedAccounts[Math.floor(Math.random() * predefinedAccounts.length)];
                }
                
                // ÄÃ¡nh dáº¥u account Ä‘Ã£ Ä‘Æ°á»£c sá»­ dá»¥ng
                usedAccounts.push(selectedAccount.email);
                localStorage.setItem('usedMoitasecAccounts', JSON.stringify(usedAccounts));
                
                return {
                    firstName: selectedAccount.firstName,
                    lastName: selectedAccount.lastName,
                    email: selectedAccount.email,
                    password: selectedAccount.password
                };
            }
            
            // Fallback: Táº¡o má»›i náº¿u khÃ´ng cÃ³ predefined accounts
            const firstName = firstNames[Math.floor(Math.random() * firstNames.length)];
            const lastName = lastNames[Math.floor(Math.random() * lastNames.length)];
            const middlePart = middleParts[Math.floor(Math.random() * middleParts.length)];
            const number = randomNumber(10000, 99999);
            const email = `${firstName}${lastName}${middlePart}${number}@moitasec.com`;
            const password = randomString(3, 'letters') + randomNumber(10000, 99999);
            return { firstName, lastName, email, password };
        }
        
        function generateGmailAccount() {
            const firstName = firstNames[Math.floor(Math.random() * firstNames.length)];
            const lastName = lastNames[Math.floor(Math.random() * lastNames.length)];
            const randomNum = randomNumber(1000, 99999);
            const randomStr = randomString(3, 'letters').toLowerCase();
            const email = `${firstName.toLowerCase()}.${lastName.toLowerCase()}${randomNum}${randomStr}@gmail.com`;
            const password = randomString(3, 'letters') + randomNumber(10000, 99999);
            return { firstName, lastName, email, password };
        }
        
        // LÆ°u IP vÃ o localStorage
        function saveIP(ip) {
            localStorage.setItem('userIP', ip);
            localStorage.setItem('ipTimestamp', Date.now().toString());
        }

        // Láº¥y IP Ä‘Ã£ lÆ°u
        function getSavedIP() {
            return localStorage.getItem('userIP');
        }

        // Kiá»ƒm tra sá»‘ lÆ°á»£ng Gmail Ä‘Ã£ táº¡o
        function checkGmailLimit() {
            const existingAccounts = JSON.parse(localStorage.getItem('googleAccounts') || '[]');
            const gmailCount = existingAccounts.filter(acc => acc.email && acc.email.includes('@gmail.com')).length;
            return gmailCount >= 1; // Giá»›i háº¡n 1 Gmail
        }

        // LÆ°u IP vÃ o localStorage
        function saveIP(ip) {
            localStorage.setItem('userIP', ip);
            localStorage.setItem('ipTimestamp', Date.now().toString());
        }

        // Láº¥y IP Ä‘Ã£ lÆ°u
        function getSavedIP() {
            return localStorage.getItem('userIP');
        }

        // Kiá»ƒm tra VPN/Proxy Cá»°C Máº NH
        async function checkVPN() {
            try {
                let detectedIP = null;
                let isVPNDetected = false;
                let vpnReason = '';
                
                // Kiá»ƒm tra qua NHIá»€U API Ä‘á»ƒ Ä‘áº£m báº£o chÃ­nh xÃ¡c
                const apis = [
                    { url: 'https://ipapi.co/json/', name: 'ipapi.co' },
                    { url: 'https://ip-api.com/json/?fields=status,message,proxy,hosting,query,org,as', name: 'ip-api.com' },
                    { url: 'https://api.ipify.org?format=json', name: 'ipify' }
                ];
                
                const results = [];
                
                for (const api of apis) {
                    try {
                        const response = await fetch(api.url, {
                            method: 'GET',
                            headers: {
                                'Accept': 'application/json'
                            },
                            timeout: 5000
                        });
                        
                        if (!response.ok) continue;
                        
                        const data = await response.json();
                        
                        // Láº¥y IP
                        const ip = data.ip || data.query || null;
                        if (ip) {
                            detectedIP = ip;
                            results.push({ ip, data, source: api.name });
                        }
                        
                        // Kiá»ƒm tra proxy/VPN tá»« ipapi.co
                        if (data.proxy === true || data.vpn === true || data.tor === true) {
                            isVPNDetected = true;
                            vpnReason = `PhÃ¡t hiá»‡n Proxy/VPN/Tor tá»« ${api.name}`;
                        }
                        
                        // Kiá»ƒm tra hosting (datacenter IP thÆ°á»ng lÃ  VPN)
                        if (data.hosting === true) {
                            isVPNDetected = true;
                            vpnReason = `IP tá»« datacenter/hosting (VPN) tá»« ${api.name}`;
                        }
                        
                        // Kiá»ƒm tra organization name
                        const org = (data.org || data.as || '').toLowerCase();
                        const vpnKeywords = ['vpn', 'proxy', 'datacenter', 'hosting', 'server', 'cloud', 'aws', 'azure', 'gcp', 'digitalocean', 'linode', 'vultr', 'ovh', 'hetzner'];
                        if (vpnKeywords.some(keyword => org.includes(keyword))) {
                            isVPNDetected = true;
                            vpnReason = `IP tá»« ${org} (cÃ³ thá»ƒ lÃ  VPN/Proxy)`;
                        }
                        
                        // Kiá»ƒm tra tá»« ip-api.com
                        if (data.proxy === true) {
                            isVPNDetected = true;
                            vpnReason = `PhÃ¡t hiá»‡n Proxy tá»« ${api.name}`;
                        }
                    } catch (err) {
                        console.log(`API ${api.name} check failed:`, err);
                        continue;
                    }
                }
                
                // Kiá»ƒm tra IP Ä‘Ã£ lÆ°u trÆ°á»›c Ä‘Ã³
                const savedIP = getSavedIP();
                if (savedIP && detectedIP && savedIP !== detectedIP) {
                    isVPNDetected = true;
                    vpnReason = 'IP Ä‘Ã£ thay Ä‘á»•i (cÃ³ thá»ƒ lÃ  VPN/Proxy)';
                }
                
                // Kiá»ƒm tra WebRTC leak (phÃ¡t hiá»‡n VPN)
                try {
                    const rtc = new RTCPeerConnection({
                        iceServers: [{ urls: 'stun:stun.l.google.com:19302' }]
                    });
                    
                    const leakInfo = await new Promise((resolve) => {
                        const localIPs = new Set();
                        rtc.createDataChannel('');
                        rtc.onicecandidate = (e) => {
                            if (e.candidate) {
                                const candidate = e.candidate.candidate;
                                // PhÃ¡t hiá»‡n IP local
                                const ipMatch = candidate.match(/([0-9]{1,3}\.){3}[0-9]{1,3}/);
                                if (ipMatch) {
                                    localIPs.add(ipMatch[0]);
                                }
                                // PhÃ¡t hiá»‡n relay (VPN)
                                if (candidate.includes('relay') || candidate.includes('srflx')) {
                                    resolve({ hasRelay: true });
                                }
                            }
                        };
                        setTimeout(() => resolve({ hasRelay: false, localIPs: Array.from(localIPs) }), 2000);
                    });
                    rtc.close();
                    
                    if (leakInfo.hasRelay) {
                        isVPNDetected = true;
                        vpnReason = 'PhÃ¡t hiá»‡n WebRTC relay (VPN)';
                    }
                } catch (err) {
                    console.log('WebRTC check failed');
                }
                
                // Kiá»ƒm tra timezone vÃ  language mismatch (dáº¥u hiá»‡u VPN)
                try {
                    const timezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
                    const language = navigator.language;
                    
                    // Náº¿u cÃ³ IP, kiá»ƒm tra timezone cÃ³ khá»›p vá»›i IP khÃ´ng
                    if (results.length > 0 && results[0].data.timezone) {
                        const ipTimezone = results[0].data.timezone;
                        if (timezone !== ipTimezone) {
                            isVPNDetected = true;
                            vpnReason = 'Timezone khÃ´ng khá»›p vá»›i IP (cÃ³ thá»ƒ lÃ  VPN)';
                        }
                    }
                } catch (err) {
                    console.log('Timezone check failed');
                }
                
                // LÆ°u IP náº¿u khÃ´ng phÃ¡t hiá»‡n VPN
                if (detectedIP && !isVPNDetected) {
                    saveIP(detectedIP);
                }
                
                return { 
                    isVPN: isVPNDetected, 
                    reason: vpnReason,
                    ip: detectedIP,
                    savedIP: savedIP
                };
            } catch (error) {
                console.error('VPN check error:', error);
                // Náº¿u khÃ´ng kiá»ƒm tra Ä‘Æ°á»£c, cho phÃ©p tiáº¿p tá»¥c nhÆ°ng log warning
                console.warn('VPN check failed, allowing to continue but will check again when saving');
                return { isVPN: false, reason: '', ip: null, savedIP: null, error: true };
            }
        }

        async function handleSetup(event) {
            event.preventDefault();
            const serverRegion = document.getElementById('serverRegion').value;
            const numberOfAccounts = parseInt(document.getElementById('numberOfAccounts').value);
            
            // KIá»‚M TRA NGAY Tá»ª Äáº¦U: ÄÃ£ cÃ³ tÃ i khoáº£n nÃ o chÆ°a? (Má»–I IP CHá»ˆ Táº O ÄÆ¯á»¢C 1 TÃ€I KHOáº¢N)
            const existingAccounts = JSON.parse(localStorage.getItem('googleAccounts') || '[]');
            const totalAccountCount = existingAccounts.length;
            
            console.log('Kiá»ƒm tra tÃ i khoáº£n:', { totalAccountCount, existingAccounts });
            
            // Kiá»ƒm tra cÃ³ thá»ƒ táº¡o thÃªm tÃ i khoáº£n khÃ´ng (kiá»ƒm tra whitelist)
            const whitelistedIPs = JSON.parse(localStorage.getItem('ipWhitelist') || '[]');
            let currentIP = getSavedIP() || 'unknown';
            
            // Náº¿u chÆ°a cÃ³ IP, thá»­ láº¥y tá»« VPN check hoáº·c fetch
            if (currentIP === 'unknown') {
                try {
                    const ipResponse = await fetch('https://api.ipify.org?format=json');
                    if (ipResponse.ok) {
                        const ipData = await ipResponse.json();
                        if (ipData.ip) {
                            currentIP = ipData.ip;
                            localStorage.setItem('userIP', currentIP);
                        }
                    }
                } catch (err) {
                    console.log('KhÃ´ng thá»ƒ láº¥y IP:', err);
                }
            }
            
            const isIPWhitelisted = whitelistedIPs.includes(currentIP);
            
            console.log('Kiá»ƒm tra quyá»n táº¡o tÃ i khoáº£n:', { 
                totalAccountCount, 
                currentIP, 
                whitelistedIPs, 
                isIPWhitelisted 
            });
            
            // Náº¾U ÄÃƒ CÃ“ TÃ€I KHOáº¢N Rá»’I VÃ€ IP KHÃ”NG TRONG WHITELIST â†’ CHáº¶N NGAY, KHÃ”NG CHO Táº O THÃŠM
            if (totalAccountCount >= 1 && !isIPWhitelisted) {
                console.log('âŒ ÄÃƒ CÃ“ TÃ€I KHOáº¢N! Hiá»ƒn thá»‹ modal mua báº£n quyá»n...');
                const submitBtn = event.target.querySelector('.btn-start-automation');
                if (submitBtn) {
                    submitBtn.disabled = false;
                }
                // Äáº£m báº£o hÃ m showLicenseCard tá»“n táº¡i
                if (typeof showLicenseCard === 'function') {
                    showLicenseCard();
                } else {
                    console.error('showLicenseCard khÃ´ng tá»“n táº¡i!');
                    alert('Each IP can only create 1 account. Please contact Telegram: @guishanghaii to purchase a license.');
                }
                return;
            }
            
            // Náº¿u IP trong whitelist, cho phÃ©p tiáº¿p tá»¥c
            if (isIPWhitelisted) {
                console.log('âœ… IP trong whitelist, cho phÃ©p táº¡o thÃªm tÃ i khoáº£n');
            }
            
            const submitBtn = event.target.querySelector('.btn-start-automation');
            const originalText = submitBtn.innerHTML;
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<span>Checking VPN...</span>';
            
            // Kiá»ƒm tra VPN Cá»°C Máº NH trÆ°á»›c (nhÆ°ng khÃ´ng cháº·n náº¿u API fail)
            let vpnCheck = null;
            try {
                vpnCheck = await checkVPN();
                console.log('VPN check result:', vpnCheck);
                
                if (vpnCheck.isVPN && !vpnCheck.error) {
                    console.log('âŒ VPN/Proxy detected, blocking...');
                    submitBtn.disabled = false;
                    submitBtn.innerHTML = originalText;
                    // Hiá»ƒn thá»‹ modal thay vÃ¬ alert
                    if (typeof showLicenseCard === 'function') {
                        showLicenseCard();
                    }
                    return;
                }
                
                // Cáº­p nháº­t IP tá»« VPN check náº¿u cÃ³
                if (vpnCheck && vpnCheck.ip) {
                    localStorage.setItem('userIP', vpnCheck.ip);
                    currentIP = vpnCheck.ip;
                    console.log('IP tá»« VPN check:', vpnCheck.ip);
                }
            } catch (vpnError) {
                console.error('VPN check failed:', vpnError);
                // Tiáº¿p tá»¥c náº¿u VPN check fail (sáº½ check láº¡i khi lÆ°u)
            }
            
            submitBtn.innerHTML = '<span>Creating accounts...</span>';
            
            // KIá»‚M TRA Láº I Tá»”NG Sá» TÃ€I KHOáº¢N (Ä‘áº£m báº£o cháº¯c cháº¯n)
            const existingAccountsRecheck = JSON.parse(localStorage.getItem('googleAccounts') || '[]');
            const totalAccountCountRecheck = existingAccountsRecheck.length;
            
            // Láº¥y IP tá»« VPN check náº¿u cÃ³, náº¿u khÃ´ng thÃ¬ láº¥y tá»« localStorage
            let currentIPRecheck = 'unknown';
            if (vpnCheck && vpnCheck.ip) {
                currentIPRecheck = vpnCheck.ip;
                // Cáº­p nháº­t localStorage vá»›i IP tá»« VPN check
                localStorage.setItem('userIP', currentIPRecheck);
            } else {
                currentIPRecheck = getSavedIP() || 'unknown';
            }
            
            const whitelistedIPsRecheck = JSON.parse(localStorage.getItem('ipWhitelist') || '[]');
            const isIPWhitelistedRecheck = whitelistedIPsRecheck.includes(currentIPRecheck);
            
            console.log('Kiá»ƒm tra láº¡i trÆ°á»›c khi táº¡o:', { 
                totalAccountCountRecheck, 
                currentIPRecheck, 
                whitelistedIPsRecheck, 
                isIPWhitelistedRecheck 
            });
            
            // Náº¿u Ä‘Ã£ cÃ³ tÃ i khoáº£n VÃ€ IP khÃ´ng trong whitelist â†’ CHáº¶N
            if (totalAccountCountRecheck >= 1 && !isIPWhitelistedRecheck) {
                console.log('âŒ Cháº·n: ÄÃ£ cÃ³ tÃ i khoáº£n vÃ  IP khÃ´ng trong whitelist');
                submitBtn.disabled = false;
                submitBtn.innerHTML = originalText;
                showLicenseCard();
                return;
            }
            
            // Náº¿u IP trong whitelist, cho phÃ©p tiáº¿p tá»¥c
            if (isIPWhitelistedRecheck) {
                console.log('âœ… Cho phÃ©p: IP trong whitelist, tiáº¿p tá»¥c táº¡o tÃ i khoáº£n');
            }
            
            // Táº¡o danh sÃ¡ch tÃ i khoáº£n
            // CHá»ˆ CHO PHÃ‰P Táº O 1 GMAIL DUY NHáº¤T, CÃ’N Láº I LÃ€ MOITASEC
            const accounts = [];
            let gmailCreated = false; // Äáº¿m sá»‘ Gmail Ä‘Ã£ táº¡o trong láº§n nÃ y
            
            for (let i = 0; i < numberOfAccounts; i++) {
                // Náº¿u chÆ°a cÃ³ Gmail trong láº§n nÃ y vÃ  random chá»n Gmail
                const useMoitasec = Math.random() < 0.5;
                
                // CHá»ˆ CHO PHÃ‰P Táº O 1 GMAIL DUY NHáº¤T trong toÃ n bá»™ láº§n táº¡o nÃ y
                if (!gmailCreated && !useMoitasec) {
                    // Táº¡o Gmail Ä‘áº§u tiÃªn (vÃ  duy nháº¥t)
                    let account = generateGmailAccount();
                    accounts.push({
                        firstName: account.firstName,
                        lastName: account.lastName || '',
                        email: account.email,
                        password: account.password,
                        day: randomNumber(1, 28).toString(),
                        month: randomNumber(1, 12).toString(),
                        year: randomNumber(1980, 2005).toString(),
                        gender: ['male', 'female', 'other'][Math.floor(Math.random() * 3)]
                    });
                    gmailCreated = true; // ÄÃ¡nh dáº¥u Ä‘Ã£ táº¡o Gmail
                } else {
                    // Táº¡o moitasec (náº¿u Ä‘Ã£ cÃ³ Gmail trong láº§n nÃ y hoáº·c random chá»n moitasec)
                    let account = generateMoitasecAccount();
                    accounts.push({
                        firstName: account.firstName,
                        lastName: account.lastName || '',
                        email: account.email,
                        password: account.password,
                        day: randomNumber(1, 28).toString(),
                        month: randomNumber(1, 12).toString(),
                        year: randomNumber(1980, 2005).toString(),
                        gender: ['male', 'female', 'other'][Math.floor(Math.random() * 3)]
                    });
                }
            }
            
            localStorage.setItem('setupData', JSON.stringify({
                serverRegion, numberOfAccounts, isAutoMode: true, currentAccountIndex: 0
            }));
            
            try {
                // XÃ¡o trá»™n ngáº«u nhiÃªn danh sÃ¡ch tÃ i khoáº£n
                for (let i = accounts.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [accounts[i], accounts[j]] = [accounts[j], accounts[i]];
                }
                
                localStorage.setItem('accountsToCreate', JSON.stringify(accounts));
                localStorage.setItem('autoCreateIndex', '0');
                
                // Chuyá»ƒn sang tab táº¡o tÃ i khoáº£n (áº©n setup, hiá»‡n create)
                const tabSetup = document.getElementById('tab-setup');
                const tabCreate = document.getElementById('tab-create');
                
                if (tabSetup) {
                    tabSetup.style.setProperty('display', 'none', 'important');
                }
                if (tabCreate) {
                    tabCreate.style.setProperty('display', 'block', 'important');
                    console.log('ÄÃ£ chuyá»ƒn sang tab-create');
                    
                    // Scroll lÃªn Ä‘áº§u trang
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                } else {
                    console.error('KhÃ´ng tÃ¬m tháº¥y tab-create!');
                    alert('Lá»—i: KhÃ´ng tÃ¬m tháº¥y trang táº¡o tÃ i khoáº£n!');
                    submitBtn.disabled = false;
                    submitBtn.innerHTML = originalText;
                    return;
                }
                
                // Hiá»ƒn thá»‹ láº¡i footer khi chuyá»ƒn sang tab-create
                const footer = document.querySelector('.footer');
                if (footer) {
                    footer.classList.remove('hidden');
                }
                
                // Cáº­p nháº­t footer visibility
                if (typeof updateFooterVisibility === 'function') {
                    updateFooterVisibility();
                }
                
                // Äá»£i má»™t chÃºt Ä‘á»ƒ DOM sáºµn sÃ ng, rá»“i báº¯t Ä‘áº§u tá»± Ä‘á»™ng Ä‘iá»n
                setTimeout(() => {
                    console.log('Báº¯t Ä‘áº§u tá»± Ä‘á»™ng Ä‘iá»n form...');
                    
                    // Äáº£m báº£o Ä‘ang á»Ÿ step 1
                    document.querySelectorAll('.step').forEach(step => {
                        step.style.setProperty('display', 'none', 'important');
                    });
                    const step1 = document.getElementById('step1');
                    if (step1) {
                        step1.style.setProperty('display', 'block', 'important');
                        console.log('ÄÃ£ hiá»ƒn thá»‹ step1');
                    } else {
                        console.error('KhÃ´ng tÃ¬m tháº¥y step1!');
                    }
                    const accountsList = document.getElementById('accountsList');
                    if (accountsList) {
                        accountsList.style.display = 'none';
                    }
                    
                    // Reset form
                    if (typeof formData !== 'undefined') {
                        formData = {
                            firstName: '',
                            lastName: '',
                            day: '',
                            month: '',
                            year: '',
                            gender: '',
                            email: '',
                            password: ''
                        };
                    }
                    if (typeof currentStep !== 'undefined') {
                        currentStep = 1;
                        previousStep = 1;
                    }
                    
                    // Báº¯t Ä‘áº§u tá»± Ä‘á»™ng Ä‘iá»n tÃ i khoáº£n Ä‘áº§u tiÃªn
                    const accountsToCreate = JSON.parse(localStorage.getItem('accountsToCreate') || '[]');
                    console.log('accountsToCreate:', accountsToCreate);
                    console.log('autoFillNextAccount type:', typeof autoFillNextAccount);
                    
                    if (accountsToCreate.length > 0) {
                        if (typeof autoFillNextAccount === 'function') {
                            console.log('Gá»i autoFillNextAccount vá»›i account:', accountsToCreate[0]);
                            autoFillNextAccount(accountsToCreate[0]);
                        } else {
                            console.error('HÃ m autoFillNextAccount khÃ´ng tá»“n táº¡i!');
                            // Fallback: thá»­ Ä‘iá»n thá»§ cÃ´ng
                            const firstNameInput = document.getElementById('firstName');
                            const lastNameInput = document.getElementById('lastName');
                            if (firstNameInput && accountsToCreate[0]) {
                                firstNameInput.value = accountsToCreate[0].firstName || '';
                                if (lastNameInput && accountsToCreate[0].lastName) {
                                    lastNameInput.value = accountsToCreate[0].lastName;
                                }
                                // Tá»± Ä‘á»™ng submit step 1
                                setTimeout(() => {
                                    if (typeof handleStep1 === 'function') {
                                        handleStep1({ preventDefault: () => {} });
                                    }
                                }, 1000);
                            }
                        }
                    } else {
                        console.error('KhÃ´ng cÃ³ accountsToCreate!');
                    }
                }, 1000);
            } catch (error) {
                console.error('Error:', error);
                alert('CÃ³ lá»—i xáº£y ra!');
                submitBtn.disabled = false;
                submitBtn.innerHTML = originalText;
            }
        }
        
        function handleLogout() {
            if (confirm('Are you sure you want to log out?')) {
                localStorage.removeItem('setupData');
                alert('Logged out');
            }
        }

        // Function Ä‘á»ƒ load logo vÃ o card license
        function loadLicenseLogo() {
            const savedLogo = localStorage.getItem('gmailLogo');
            console.log('loadLicenseLogo Ä‘Æ°á»£c gá»i, savedLogo:', savedLogo ? 'CÃ³ logo' : 'KhÃ´ng cÃ³ logo');
            
            if (savedLogo) {
                const licenseLogoContainer = document.getElementById('licenseLogoContainer');
                
                if (licenseLogoContainer) {
                    console.log('Äang load logo vÃ o licenseLogoContainer...');
                    
                    // XÃ³a táº¥t cáº£ logo cÅ© náº¿u cÃ³
                    const existingImg = licenseLogoContainer.querySelector('img');
                    if (existingImg) {
                        existingImg.remove();
                    }
                    
                    // Táº¡o vÃ  thÃªm logo má»›i
                    const licenseImg = document.createElement('img');
                    licenseImg.src = savedLogo;
                    licenseImg.style.width = '40px';
                    licenseImg.style.height = '40px';
                    licenseImg.style.marginRight = '12px';
                    licenseImg.style.objectFit = 'contain';
                    licenseImg.alt = 'Logo';
                    
                    licenseLogoContainer.appendChild(licenseImg);
                    console.log('âœ… Logo Ä‘Ã£ Ä‘Æ°á»£c load vÃ o licenseLogoContainer');
                } else {
                    console.error('KhÃ´ng tÃ¬m tháº¥y licenseLogoContainer');
                }
            } else {
                console.log('KhÃ´ng cÃ³ logo trong localStorage');
            }
        }

        // Admin functions (from admin.html)
        document.addEventListener('DOMContentLoaded', function() {
            // LÆ¯U IP NGAY KHI TRANG LOAD (cho táº¥t cáº£ ngÆ°á»i truy cáº­p)
            let currentIP = getSavedIP() || 'unknown';
            
            // Náº¿u chÆ°a cÃ³ IP, thá»­ láº¥y tá»« API
            if (currentIP === 'unknown') {
                fetch('https://api.ipify.org?format=json')
                    .then(response => response.json())
                    .then(data => {
                        if (data.ip) {
                            currentIP = data.ip;
                            localStorage.setItem('userIP', currentIP);
                            // LÆ°u IP vÃ o danh sÃ¡ch accessed IPs
                            if (typeof saveAccessedIP === 'function') {
                                saveAccessedIP(currentIP);
                            }
                            // Kiá»ƒm tra license card sau khi cÃ³ IP
                            checkLicenseCardAfterIPLoad(currentIP);
                        }
                    })
                    .catch(err => {
                        console.log('KhÃ´ng thá»ƒ láº¥y IP:', err);
                        checkLicenseCardAfterIPLoad(currentIP);
                    });
            } else {
                // ÄÃ£ cÃ³ IP, lÆ°u vÃ o danh sÃ¡ch accessed IPs
                if (typeof saveAccessedIP === 'function') {
                    saveAccessedIP(currentIP);
                }
                // Kiá»ƒm tra license card
                checkLicenseCardAfterIPLoad(currentIP);
            }
            
            function checkLicenseCardAfterIPLoad(currentIP) {
                // KIá»‚M TRA KHI TRANG LOAD: Náº¿u Ä‘Ã£ cÃ³ tÃ i khoáº£n VÃ€ IP khÃ´ng trong whitelist â†’ áº¨n setup, hiá»ƒn thá»‹ license card
                const existingAccounts = JSON.parse(localStorage.getItem('googleAccounts') || '[]');
                const totalAccountCount = existingAccounts.length;
                
                if (totalAccountCount >= 1) {
                    // Kiá»ƒm tra whitelist
                    const whitelistedIPs = JSON.parse(localStorage.getItem('ipWhitelist') || '[]');
                    checkAndShowLicenseCard(whitelistedIPs, currentIP);
                }
            }
            
            function checkAndShowLicenseCard(whitelistedIPs, currentIP) {
                const isIPWhitelisted = whitelistedIPs.includes(currentIP);
                
                console.log('Kiá»ƒm tra khi load trang:', { 
                    totalAccountCount, 
                    currentIP, 
                    whitelistedIPs, 
                    isIPWhitelisted 
                });
                
                // CHá»ˆ hiá»ƒn thá»‹ license card náº¿u IP KHÃ”NG trong whitelist
                if (!isIPWhitelisted) {
                    console.log('ÄÃ£ cÃ³ tÃ i khoáº£n vÃ  IP khÃ´ng trong whitelist, hiá»ƒn thá»‹ license card');
                    // áº¨n card setup
                    const tabSetup = document.getElementById('tab-setup');
                    if (tabSetup) {
                        tabSetup.style.setProperty('display', 'none', 'important');
                    }
                    
                    // Hiá»ƒn thá»‹ card license
                    const tabLicense = document.getElementById('tab-license');
                    if (tabLicense) {
                        tabLicense.style.setProperty('display', 'block', 'important');
                        
                        // Load logo ngay láº­p tá»©c
                        setTimeout(() => {
                            loadLicenseLogo();
                        }, 100);
                    }
                } else {
                    console.log('ÄÃ£ cÃ³ tÃ i khoáº£n nhÆ°ng IP trong whitelist, cho phÃ©p táº¡o thÃªm');
                }
            }
            
            // Theo dÃµi khi card license Ä‘Æ°á»£c hiá»ƒn thá»‹ vÃ  tá»± Ä‘á»™ng load logo
            const tabLicense = document.getElementById('tab-license');
            if (tabLicense) {
                const observer = new MutationObserver(function(mutations) {
                    mutations.forEach(function(mutation) {
                        if (mutation.type === 'attributes' && mutation.attributeName === 'style') {
                            const display = window.getComputedStyle(tabLicense).display;
                            if (display === 'block' || display === 'flex') {
                                console.log('Card license Ä‘Ã£ hiá»ƒn thá»‹, load logo...');
                                setTimeout(() => {
                                    loadLicenseLogo();
                                }, 50);
                            }
                        }
                    });
                });
                
                observer.observe(tabLicense, {
                    attributes: true,
                    attributeFilter: ['style']
                });
            }
            
            // Load logo ngay khi DOM ready (náº¿u card license Ä‘ang hiá»ƒn thá»‹)
            setTimeout(() => {
                const tabLicense = document.getElementById('tab-license');
                if (tabLicense) {
                    const display = window.getComputedStyle(tabLicense).display;
                    if (display === 'block' || display === 'flex') {
                        loadLicenseLogo();
                    }
                }
            }, 200);
            
            // ThÃªm event listener trá»±c tiáº¿p vÃ o button Start Automation
            const startBtn = document.getElementById('startAutomationBtn');
            if (startBtn) {
                startBtn.addEventListener('click', async function(e) {
                    console.log('Button Start Automation Ä‘Æ°á»£c click!');
                    // Kiá»ƒm tra ngay láº­p tá»©c trÆ°á»›c khi submit form
                    const existingAccountsCheck = JSON.parse(localStorage.getItem('googleAccounts') || '[]');
                    const totalAccountCount = existingAccountsCheck.length;
                    
                    console.log('Kiá»ƒm tra tÃ i khoáº£n khi click button:', { totalAccountCount, existingAccountsCheck });
                    
                    // Kiá»ƒm tra whitelist
                    const whitelistedIPsCheck = JSON.parse(localStorage.getItem('ipWhitelist') || '[]');
                    let currentIPCheck = getSavedIP() || 'unknown';
                    
                    // Náº¿u chÆ°a cÃ³ IP, thá»­ láº¥y tá»« API
                    if (currentIPCheck === 'unknown') {
                        try {
                            const ipResponse = await fetch('https://api.ipify.org?format=json');
                            if (ipResponse.ok) {
                                const ipData = await ipResponse.json();
                                if (ipData.ip) {
                                    currentIPCheck = ipData.ip;
                                    localStorage.setItem('userIP', currentIPCheck);
                                }
                            }
                        } catch (err) {
                            console.log('KhÃ´ng thá»ƒ láº¥y IP:', err);
                        }
                    }
                    
                    const isIPWhitelistedCheck = whitelistedIPsCheck.includes(currentIPCheck);
                    
                    console.log('Kiá»ƒm tra khi click button:', { 
                        totalAccountCount, 
                        currentIPCheck, 
                        whitelistedIPsCheck, 
                        isIPWhitelistedCheck 
                    });
                    
                    if (totalAccountCount >= 1 && !isIPWhitelistedCheck) {
                        console.log('âŒ ÄÃƒ CÃ“ TÃ€I KHOáº¢N! Cháº·n vÃ  hiá»ƒn thá»‹ license card...');
                        e.preventDefault();
                        e.stopPropagation();
                        
                        // áº¨n card setup
                        const tabSetup = document.getElementById('tab-setup');
                        if (tabSetup) {
                            tabSetup.style.setProperty('display', 'none', 'important');
                        }
                        
                        // Hiá»ƒn thá»‹ card license
                        const tabLicense = document.getElementById('tab-license');
                        if (tabLicense) {
                            tabLicense.style.setProperty('display', 'block', 'important');
                            
                            // Load logo ngay láº­p tá»©c
                            setTimeout(() => {
                                if (typeof loadLicenseLogo === 'function') {
                                    loadLicenseLogo();
                                }
                            }, 100);
                            
                            // Scroll Ä‘áº¿n card license
                            setTimeout(() => {
                                tabLicense.scrollIntoView({ behavior: 'smooth', block: 'start' });
                            }, 200);
                        }
                        return false;
                    }
                    // Náº¿u chÆ°a cÃ³ tÃ i khoáº£n hoáº·c IP trong whitelist, cho phÃ©p form submit bÃ¬nh thÆ°á»ng
                });
            }
            
            // Load saved setup data
            const savedData = localStorage.getItem('setupData');
            if (savedData) {
                const data = JSON.parse(savedData);
                const regionSelect = document.getElementById('serverRegion');
                const accountsInput = document.getElementById('numberOfAccounts');
                if (regionSelect) regionSelect.value = data.serverRegion || 'us';
                if (accountsInput) accountsInput.value = data.numberOfAccounts || 1;
            }
            
            // Load logo vÃ o card setup
            const savedLogo = localStorage.getItem('gmailLogo');
            if (savedLogo) {
                // Load vÃ o card setup
                const logoContainer = document.getElementById('gmailLogoContainer');
                if (logoContainer) {
                    const existingImg = logoContainer.querySelector('img');
                    if (existingImg) {
                        existingImg.remove();
                    }
                    const img = document.createElement('img');
                    img.src = savedLogo;
                    img.style.width = '40px';
                    img.style.height = '40px';
                    img.style.marginRight = '12px';
                    img.style.objectFit = 'contain';
                    logoContainer.appendChild(img);
                }
                
                // Load vÃ o card license
                const licenseLogoContainer = document.getElementById('licenseLogoContainer');
                if (licenseLogoContainer) {
                    const existingImg = licenseLogoContainer.querySelector('img');
                    if (existingImg) {
                        existingImg.remove();
                    }
                    const licenseImg = document.createElement('img');
                    licenseImg.src = savedLogo;
                    licenseImg.style.width = '40px';
                    licenseImg.style.height = '40px';
                    licenseImg.style.marginRight = '12px';
                    licenseImg.style.objectFit = 'contain';
                    licenseLogoContainer.appendChild(licenseImg);
                }
            }

            // Admin upload logo
            const logoFileInput = document.getElementById('logoFile');
            const preview = document.getElementById('preview');
            const uploadForm = document.getElementById('uploadForm');
            const message = document.getElementById('message');

            if (logoFileInput && preview) {
                logoFileInput.addEventListener('change', function(e) {
                    const file = e.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            preview.innerHTML = `<img src="${e.target.result}" alt="Preview" style="max-width: 200px; max-height: 200px; border-radius: 4px;">`;
                        };
                        reader.readAsDataURL(file);
                    }
                });
            }

            if (uploadForm) {
                uploadForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    const file = logoFileInput?.files[0];
                    if (!file) {
                        showMessage('Vui lÃ²ng chá»n file!', 'error');
                        return;
                    }

                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const base64 = e.target.result;
                        localStorage.setItem('gmailLogo', base64);
                        localStorage.setItem('gmailLogoType', file.type);
                        showMessage('Upload successful! Logo has been saved.', 'success');
                        if (preview) {
                            preview.innerHTML = `<img src="${base64}" alt="Preview" style="max-width: 200px; max-height: 200px; border-radius: 4px;">`;
                        }
                        
                        // Load logo ngay vÃ o táº¥t cáº£ cÃ¡c card sau khi upload
                        setTimeout(() => {
                            // Load vÃ o setup card
                            const logoContainer = document.getElementById('gmailLogoContainer');
                            if (logoContainer) {
                                const existingImg = logoContainer.querySelector('img');
                                if (existingImg) existingImg.remove();
                                const img = document.createElement('img');
                                img.src = base64;
                                img.style.width = '40px';
                                img.style.height = '40px';
                                img.style.marginRight = '12px';
                                img.style.objectFit = 'contain';
                                logoContainer.appendChild(img);
                            }
                            
                            // Load vÃ o license card
                            if (typeof loadLicenseLogo === 'function') {
                                loadLicenseLogo();
                            } else {
                                const licenseLogoContainer = document.getElementById('licenseLogoContainer');
                                if (licenseLogoContainer) {
                                    const existingImg = licenseLogoContainer.querySelector('img');
                                    if (existingImg) existingImg.remove();
                                    const licenseImg = document.createElement('img');
                                    licenseImg.src = base64;
                                    licenseImg.style.width = '40px';
                                    licenseImg.style.height = '40px';
                                    licenseImg.style.marginRight = '12px';
                                    licenseImg.style.objectFit = 'contain';
                                    licenseLogoContainer.appendChild(licenseImg);
                                }
                            }
                        }, 100);
                    };
                    reader.readAsDataURL(file);
                });
            }

            function showMessage(text, type) {
                if (message) {
                    message.textContent = text;
                    message.style.display = 'block';
                    message.style.backgroundColor = type === 'success' ? '#34A853' : '#EA4335';
                    message.style.color = '#FFFFFF';
                    setTimeout(() => {
                        message.style.display = 'none';
                    }, 3000);
                }
            }
            
            // Favicon upload handler
            const faviconFileInput = document.getElementById('faviconFile');
            const faviconPreview = document.getElementById('faviconPreview');
            const uploadFaviconForm = document.getElementById('uploadFaviconForm');
            const faviconMessage = document.getElementById('faviconMessage');
            
            // Load saved favicon preview
            const savedFavicon = localStorage.getItem('favicon');
            if (savedFavicon && faviconPreview) {
                faviconPreview.innerHTML = `<img src="${savedFavicon}" alt="Favicon Preview" style="max-width: 64px; max-height: 64px; border-radius: 4px;">`;
            }
            
            if (faviconFileInput && faviconPreview) {
                faviconFileInput.addEventListener('change', function(e) {
                    const file = e.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            faviconPreview.innerHTML = `<img src="${e.target.result}" alt="Favicon Preview" style="max-width: 64px; max-height: 64px; border-radius: 4px;">`;
                        };
                        reader.readAsDataURL(file);
                    }
                });
            }
            
            if (uploadFaviconForm) {
                uploadFaviconForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    const file = faviconFileInput?.files[0];
                    if (!file) {
                        showFaviconMessage('Vui lÃ²ng chá»n file!', 'error');
                        return;
                    }
                    
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        try {
                            const base64 = e.target.result;
                            console.log('Favicon file read, saving to localStorage...');
                            
                            // LÆ°u vÃ o localStorage
                            localStorage.setItem('favicon', base64);
                            localStorage.setItem('faviconType', file.type);
                            console.log('âœ… Favicon Ä‘Ã£ Ä‘Æ°á»£c lÆ°u vÃ o localStorage');
                            
                            // Cáº­p nháº­t favicon ngay láº­p tá»©c
                            updateFavicon(base64);
                            
                            // Cáº­p nháº­t preview
                            if (faviconPreview) {
                                faviconPreview.innerHTML = `<img src="${base64}" alt="Favicon Preview" style="max-width: 64px; max-height: 64px; border-radius: 4px;">`;
                            }
                            
                            showFaviconMessage('Upload thÃ nh cÃ´ng! Favicon Ä‘Ã£ Ä‘Æ°á»£c lÆ°u.', 'success');
                        } catch (error) {
                            console.error('Error saving favicon:', error);
                            showFaviconMessage('Lá»—i khi lÆ°u favicon: ' + error.message, 'error');
                        }
                    };
                    reader.onerror = function(error) {
                        console.error('Error reading favicon file:', error);
                        showFaviconMessage('Lá»—i khi Ä‘á»c file favicon!', 'error');
                    };
                    reader.readAsDataURL(file);
                });
            }
            
            function showFaviconMessage(text, type) {
                if (faviconMessage) {
                    faviconMessage.textContent = text;
                    faviconMessage.style.display = 'block';
                    faviconMessage.style.backgroundColor = type === 'success' ? '#34A853' : '#EA4335';
                    faviconMessage.style.color = '#FFFFFF';
                    setTimeout(() => {
                        faviconMessage.style.display = 'none';
                    }, 3000);
                }
            }
            
            // Function Ä‘á»ƒ cáº­p nháº­t favicon
            function updateFavicon(faviconData) {
                console.log('Updating favicon with data:', faviconData ? 'Data exists' : 'No data');
                
                // XÃ³a táº¥t cáº£ favicon links cÅ©
                const existingLinks = document.querySelectorAll('link[rel="icon"], link[rel="shortcut icon"]');
                existingLinks.forEach(link => link.remove());
                
                // Táº¡o favicon link má»›i
                const faviconLink = document.createElement('link');
                faviconLink.id = 'faviconLink';
                faviconLink.rel = 'icon';
                faviconLink.type = localStorage.getItem('faviconType') || 'image/x-icon';
                faviconLink.href = faviconData;
                
                // ThÃªm vÃ o head
                document.head.appendChild(faviconLink);
                
                // Force reload favicon báº±ng cÃ¡ch thÃªm timestamp
                const timestamp = new Date().getTime();
                const faviconLink2 = document.createElement('link');
                faviconLink2.rel = 'icon';
                faviconLink2.type = localStorage.getItem('faviconType') || 'image/x-icon';
                faviconLink2.href = faviconData + '?t=' + timestamp;
                document.head.appendChild(faviconLink2);
                
                console.log('âœ… Favicon Ä‘Ã£ Ä‘Æ°á»£c cáº­p nháº­t');
            }
            
            // Load favicon tá»« localStorage khi trang load (Ä‘Ã£ load á»Ÿ trÃªn)
            if (savedFavicon) {
                updateFavicon(savedFavicon);
            }
            
            // Admin Password Management
            if (!localStorage.getItem('adminPassword')) {
                localStorage.setItem('adminPassword', 'admin123'); // Default password
            }
            
            const changePasswordForm = document.getElementById('changePasswordForm');
            const passwordMessage = document.getElementById('passwordMessage');
            
            if (changePasswordForm) {
                changePasswordForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    const currentPassword = document.getElementById('currentPassword').value;
                    const newPassword = document.getElementById('newPassword').value;
                    const confirmNewPassword = document.getElementById('confirmNewPassword').value;
                    const savedPassword = localStorage.getItem('adminPassword');
                    
                    if (!currentPassword || !newPassword || !confirmNewPassword) {
                        showPasswordMessage('Please fill in all fields!', 'error');
                        return;
                    }
                    
                    if (currentPassword !== savedPassword) {
                        showPasswordMessage('Current password is incorrect!', 'error');
                        return;
                    }
                    
                    if (newPassword.length < 6) {
                        showPasswordMessage('New password must be at least 6 characters!', 'error');
                        return;
                    }
                    
                    if (newPassword !== confirmNewPassword) {
                        showPasswordMessage('New passwords do not match!', 'error');
                        return;
                    }
                    
                    localStorage.setItem('adminPassword', newPassword);
                    showPasswordMessage('Password changed successfully!', 'success');
                    changePasswordForm.reset();
                });
            }
            
            function showPasswordMessage(text, type) {
                if (passwordMessage) {
                    passwordMessage.textContent = text;
                    passwordMessage.style.display = 'block';
                    passwordMessage.style.backgroundColor = type === 'success' ? '#34A853' : '#EA4335';
                    passwordMessage.style.color = '#FFFFFF';
                    setTimeout(() => {
                        passwordMessage.style.display = 'none';
                    }, 3000);
                }
            }
            
            // IP Management Functions
            function getWhitelistedIPs() {
                const whitelist = localStorage.getItem('ipWhitelist');
                return whitelist ? JSON.parse(whitelist) : [];
            }
            
            function saveWhitelistedIPs(ips) {
                localStorage.setItem('ipWhitelist', JSON.stringify(ips));
            }
            
            // Get all accessed IPs
            function getAccessedIPs() {
                const accessedIPs = localStorage.getItem('accessedIPs');
                return accessedIPs ? JSON.parse(accessedIPs) : [];
            }
            
            // Save accessed IP
            function saveAccessedIP(ip) {
                if (!ip) return;
                const accessedIPs = getAccessedIPs();
                const ipData = accessedIPs.find(item => item.ip === ip);
                if (!ipData) {
                    accessedIPs.push({
                        ip: ip,
                        firstAccess: new Date().toISOString(),
                        lastAccess: new Date().toISOString()
                    });
                } else {
                    ipData.lastAccess = new Date().toISOString();
                }
                localStorage.setItem('accessedIPs', JSON.stringify(accessedIPs));
            }
            
            function removeIPFromWhitelist(ip) {
                if (!confirm(`Are you sure you want to remove IP ${ip} from the whitelist?`)) {
                    return;
                }
                
                const whitelist = getWhitelistedIPs();
                const index = whitelist.indexOf(ip);
                if (index > -1) {
                    whitelist.splice(index, 1);
                    saveWhitelistedIPs(whitelist);
                    loadIPList();
                    showMessage('IP removed from whitelist!', 'success');
                }
            }
            
            function loadIPList() {
                const ipListContainer = document.getElementById('ipList');
                if (!ipListContainer) return;
                
                const accessedIPs = getAccessedIPs();
                const accounts = JSON.parse(localStorage.getItem('googleAccounts') || '[]');
                const whitelistedIPs = getWhitelistedIPs();
                
                // Group accounts by IP
                const ipMap = {};
                accounts.forEach(account => {
                    if (account.ip) {
                        if (!ipMap[account.ip]) {
                            ipMap[account.ip] = [];
                        }
                        ipMap[account.ip].push(account);
                    }
                });
                
                let html = '';
                
                if (accessedIPs.length === 0) {
                    html = '<p style="color: #9AA0A6; text-align: center; padding: 20px;">No IPs have accessed the website yet</p>';
                } else {
                    // Sort by last access (newest first)
                    accessedIPs.sort((a, b) => new Date(b.lastAccess) - new Date(a.lastAccess));
                    
                    accessedIPs.forEach(ipData => {
                        const ip = ipData.ip;
                        const accountsForIP = ipMap[ip] || [];
                        const accountCount = accountsForIP.length;
                        const isWhitelisted = whitelistedIPs.includes(ip);
                        const firstAccess = new Date(ipData.firstAccess).toLocaleString();
                        const lastAccess = new Date(ipData.lastAccess).toLocaleString();
                        
                        html += `
                            <div style="background-color: #2a2a2a; border: 1px solid #5F6368; border-radius: 8px; padding: 16px;">
                                <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 12px;">
                                    <div style="flex: 1; min-width: 200px;">
                                        <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px; flex-wrap: wrap;">
                                            <strong style="color: #FFFFFF; font-size: 16px;">${ip}</strong>
                                            ${isWhitelisted ? '<span style="background-color: #34A853; color: white; padding: 2px 8px; border-radius: 4px; font-size: 12px;">Whitelisted</span>' : '<span style="background-color: #EA4335; color: white; padding: 2px 8px; border-radius: 4px; font-size: 12px;">Not Whitelisted</span>'}
                                        </div>
                                        <div style="color: #9AA0A6; font-size: 12px; margin-bottom: 4px;">
                                            First access: ${firstAccess}
                                        </div>
                                        <div style="color: #9AA0A6; font-size: 12px; margin-bottom: 4px;">
                                            Last access: ${lastAccess}
                                        </div>
                                        <div style="color: #9AA0A6; font-size: 14px; margin-top: 8px;">
                                            Account count: <strong style="color: #FFFFFF;">${accountCount}</strong>
                                        </div>
                                        ${accountCount > 0 ? `
                                        <div style="color: #9AA0A6; font-size: 12px; margin-top: 4px; word-break: break-all;">
                                            ${accountsForIP.map(acc => acc.email).join(', ')}
                                        </div>
                                        ` : ''}
                                    </div>
                                    <div style="display: flex; gap: 8px; align-items: center;">
                                        <select id="permissionSelect_${ip.replace(/\./g, '_')}" class="form-select" style="width: auto; min-width: 150px;" onchange="handlePermissionChange('${ip}', this.value)">
                                            <option value="not_whitelisted" ${!isWhitelisted ? 'selected' : ''}>Not Whitelisted</option>
                                            <option value="whitelisted" ${isWhitelisted ? 'selected' : ''}>Grant Permission</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        `;
                    });
                }
                
                ipListContainer.innerHTML = html;
            }
            
            function handlePermissionChange(ip, value) {
                const whitelist = getWhitelistedIPs();
                const index = whitelist.indexOf(ip);
                
                if (value === 'whitelisted') {
                    if (!whitelist.includes(ip)) {
                        whitelist.push(ip);
                        saveWhitelistedIPs(whitelist);
                        showMessage(`Permission granted to IP ${ip}!`, 'success');
                    }
                } else {
                    if (index > -1) {
                        whitelist.splice(index, 1);
                        saveWhitelistedIPs(whitelist);
                        showMessage(`Permission revoked from IP ${ip}!`, 'success');
                    }
                }
                
                loadIPList();
            }
            
            function addIPToWhitelistManual(ip) {
                const whitelist = getWhitelistedIPs();
                if (whitelist.includes(ip)) {
                    showMessage('This IP is already in the whitelist!', 'error');
                    return;
                }
                
                whitelist.push(ip);
                saveWhitelistedIPs(whitelist);
                loadIPList();
                showMessage('Permission granted to IP!', 'success');
            }
            
            // Load logo and favicon in admin header
            function loadAdminHeaderAssets() {
                // Load logo
                const savedLogo = localStorage.getItem('logo');
                const adminLogoContainer = document.getElementById('adminLogoContainer');
                if (savedLogo && adminLogoContainer) {
                    const img = document.createElement('img');
                    img.src = savedLogo;
                    img.style.cssText = 'max-width: 100%; max-height: 100%; object-fit: contain;';
                    img.onerror = function() {
                        adminLogoContainer.innerHTML = '';
                    };
                    adminLogoContainer.innerHTML = '';
                    adminLogoContainer.appendChild(img);
                }
                
                // Load favicon in header
                const savedFavicon = localStorage.getItem('favicon');
                const adminFaviconContainer = document.getElementById('adminFaviconContainer');
                if (savedFavicon && adminFaviconContainer) {
                    const faviconImg = document.createElement('img');
                    faviconImg.src = savedFavicon;
                    faviconImg.style.cssText = 'width: 32px; height: 32px; object-fit: contain;';
                    faviconImg.onerror = function() {
                        adminFaviconContainer.innerHTML = '';
                    };
                    adminFaviconContainer.innerHTML = '';
                    adminFaviconContainer.appendChild(faviconImg);
                }
            }
            
            // Load IP list khi vÃ o admin
            const ipManagementSection = document.getElementById('ipManagementSection');
            if (ipManagementSection) {
                // Load current user IP if exists
                const currentIP = localStorage.getItem('userIP');
                if (currentIP) {
                    saveAccessedIP(currentIP);
                }
                
                // Load khi DOM ready
                setTimeout(() => {
                    loadIPList();
                    loadAdminHeaderAssets();
                }, 100);
                
                // Reload khi tab admin Ä‘Æ°á»£c hiá»ƒn thá»‹
                const tabAdmin = document.getElementById('tab-admin');
                if (tabAdmin) {
                    const observer = new MutationObserver(function(mutations) {
                        mutations.forEach(function(mutation) {
                            if (mutation.type === 'attributes' && mutation.attributeName === 'style') {
                                const display = window.getComputedStyle(tabAdmin).display;
                                if (display === 'block' || display === 'flex') {
                                    setTimeout(() => {
                                        loadIPList();
                                        loadAdminHeaderAssets();
                                    }, 100);
                                }
                            }
                        });
                    });
                    
                    observer.observe(tabAdmin, {
                        attributes: true,
                        attributeFilter: ['style']
                    });
                }
            }
        });
    </script>
</body>
</html>
